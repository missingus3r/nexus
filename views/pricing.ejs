<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <%- include('partials/theme-init') %>
    <link rel="stylesheet" href="/css/pricing.css">
</head>
<body>
    <div class="page">
        <div class="glow one"></div>
        <div class="glow two"></div>

        <header>
            <div class="brand">VORTEX</div>
            <div class="page-nav">
                <button class="hamburger" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <nav class="nav-links">
                    <a href="/">Inicio</a>
                    <a href="/centinel" class="platform-btn">Centinel</a>
                    <a href="/forum-vortex" class="platform-btn">Forums</a>
                    <a href="/surlink" class="platform-btn">Surlink</a>
                    <a href="/login">Iniciar sesi√≥n</a>
                </nav>
            </div>
        </header>

        <div class="pricing-container">
            <!-- Hero Section -->
            <div class="pricing-hero">
                <h1>Elige el plan perfecto para ti</h1>
                <p>Desde seguimiento de seguridad personal hasta soluciones profesionales completas</p>

                <!-- Billing Cycle Toggle -->
                <div class="billing-toggle">
                    <span class="toggle-label" id="monthlyLabel">Mensual</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="billingToggle">
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label" id="yearlyLabel">Anual <span class="discount-badge">10% OFF</span></span>
                </div>
            </div>

            <!-- Personal Plans -->
            <section class="plans-section">
                <h2 class="section-title">Planes Personales</h2>
                <div class="plans-grid">
                    <!-- Free Plan -->
                    <div class="plan-card">
                        <div class="plan-header">
                            <h3>Free</h3>
                            <p class="plan-description">Perfecto para comenzar a explorar Vortex</p>
                        </div>
                        <div class="plan-price">
                            <div class="price-wrapper">
                                <span class="currency">$</span>
                                <span class="amount">0</span>
                                <span class="period">/mes</span>
                            </div>
                            <div class="price-secondary">$0 UYU</div>
                        </div>
                        <ul class="plan-features">
                            <li class="feature-item">‚úì Hasta 5 reportes de incidentes al mes</li>
                            <li class="feature-item">‚úì Acceso al mapa en tiempo real</li>
                            <li class="feature-item">‚úì Visualizaci√≥n de noticias geolocalizadas</li>
                            <li class="feature-item">‚úì Navegaci√≥n de Surlink (solo b√∫squeda)</li>
                            <li class="feature-item">‚úì Acceso al foro comunitario</li>
                            <li class="feature-item limitation">‚úó Sin alertas personalizadas</li>
                            <li class="feature-item limitation">‚úó Sin datos hist√≥ricos</li>
                        </ul>
                        <a href="/login" class="btn-plan">Comenzar Gratis</a>
                    </div>

                    <!-- Premium Plan -->
                    <div class="plan-card popular">
                        <div class="popular-badge">M√ÅS POPULAR</div>
                        <div class="plan-header">
                            <h3>Premium</h3>
                            <p class="plan-description">Para usuarios que quieren m√°s control</p>
                        </div>
                        <div class="plan-price">
                            <div class="price-wrapper">
                                <span class="currency">$</span>
                                <span class="amount" data-monthly="2" data-yearly="22">2</span>
                                <span class="period">/mes</span>
                            </div>
                            <div class="price-secondary" data-monthly="$88 UYU" data-yearly="$968 UYU">$88 UYU</div>
                        </div>
                        <ul class="plan-features">
                            <li class="feature-item">‚úì Reportes ilimitados de incidentes</li>
                            <li class="feature-item">‚úì Alertas personalizadas por zona</li>
                            <li class="feature-item">‚úì Acceso a datos hist√≥ricos</li>
                            <li class="feature-item">‚úì Guardar favoritos en Surlink</li>
                            <li class="feature-item">‚úì Estad√≠sticas de tu actividad</li>
                            <li class="feature-item">‚úì Todo lo del plan Free</li>
                        </ul>
                        <a href="mailto:info.vortexlabs@protonmail.com?subject=Consulta%20Plan%20Premium&body=Hola,%0A%0AMe%20gustar%C3%ADa%20contratar%20el%20plan%20Premium%20($8%20USD%20%2F%20$350%20UYU%20al%20mes).%0A%0ANombre:%20%0AEmail:%20%0ATel%C3%A9fono:%20%0A%0AGracias." class="btn-plan btn-primary">Contactar</a>
                    </div>

                    <!-- Pro Plan -->
                    <div class="plan-card">
                        <div class="plan-header">
                            <h3>Pro</h3>
                            <p class="plan-description">Para usuarios avanzados</p>
                        </div>
                        <div class="plan-price">
                            <div class="price-wrapper">
                                <span class="currency">$</span>
                                <span class="amount" data-monthly="5" data-yearly="54">5</span>
                                <span class="period">/mes</span>
                            </div>
                            <div class="price-secondary" data-monthly="$220 UYU" data-yearly="$2,376 UYU">$220 UYU</div>
                        </div>
                        <ul class="plan-features">
                            <li class="feature-item">‚úì Acceso a la API REST</li>
                            <li class="feature-item">‚úì Exportaci√≥n de datos (PDF/Excel)</li>
                            <li class="feature-item">‚úì Soporte prioritario v√≠a email</li>
                            <li class="feature-item">‚úì Todo lo del plan Premium</li>
                        </ul>
                        <a href="mailto:info.vortexlabs@protonmail.com?subject=Consulta%20Plan%20Pro&body=Hola,%0A%0AMe%20gustar%C3%ADa%20contratar%20el%20plan%20Pro%20($25%20USD%20%2F%20$1,100%20UYU%20al%20mes).%0A%0ANombre:%20%0AEmail:%20%0ATel%C3%A9fono:%20%0A%0AGracias." class="btn-plan">Contactar</a>
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section class="faq-section">
                <h2 class="section-title">Preguntas Frecuentes</h2>
                <div class="faq-grid">
                    <div class="faq-item">
                        <h3>¬øPuedo usar la plataforma sin pagar ni registrarme?</h3>
                        <p>S√≠, puedes acceder y explorar muchas funciones de Vortex sin pagar ni crear una cuenta. Solo necesitas registrarte si quieres publicar o acceder a herramientas avanzadas.</p>
                    </div>
                    <div class="faq-item">
                        <h3>¬øPuedo cambiar de plan en cualquier momento?</h3>
                        <p>S√≠, puedes actualizar o cambiar tu plan en cualquier momento. Los cambios se aplicar√°n inmediatamente.</p>
                    </div>
                    <div class="faq-item">
                        <h3>¬øQu√© m√©todos de pago aceptan?</h3>
                        <p>Aceptamos transferencias bancarias, tarjetas de cr√©dito/d√©bito, y MercadoPago. Cont√°ctanos para coordinar el m√©todo que prefieras.</p>
                    </div>
                    <div class="faq-item">
                        <h3>¬øHay descuento por pago anual?</h3>
                        <p>S√≠, ofrecemos un 10% de descuento en todos los planes si pagas anualmente.</p>
                    </div>
                    <div class="faq-item">
                        <h3>¬øPuedo cancelar mi suscripci√≥n?</h3>
                        <p>Por supuesto. Puedes cancelar tu suscripci√≥n en cualquier momento sin penalizaciones. Tendr√°s acceso hasta el final del per√≠odo pagado.</p>
                    </div>
                    <div class="faq-item">
                        <h3>¬øLos planes incluyen soporte?</h3>
                        <p>El plan Pro incluye soporte prioritario v√≠a email. Todos los usuarios pueden contactarnos para consultas generales.</p>
                    </div>
                </div>
            </section>

            <!-- CTA Section -->
            <section class="cta-section">
                <h2>¬øTienes dudas? Cont√°ctanos</h2>
                <p>Nuestro equipo est√° listo para ayudarte a elegir el mejor plan para tus necesidades</p>
                <a href="mailto:info.vortexlabs@protonmail.com" class="btn-cta">Pregunta aqu√≠ lo que quieras</a>
            </section>
        </div>

        <footer>
            <span>¬© <%= new Date().getFullYear() %> Vortex, una empresa de <a href="https://dokta.cc/" target="_blank" rel="noopener noreferrer">DOKTA</a>. Dise√±ado en Uruguay con üíô.</span>
            <span>
                <a href="/privacy">Privacidad</a> ¬∑
                <a href="/terms">T√©rminos</a>
            </span>
        </footer>
    </div>

    <script>
    let pricingData = null;

    // Load pricing settings from API
    async function loadPricing() {
        try {
            const response = await fetch('/api/pricing/settings');
            const data = await response.json();

            if (data.success) {
                pricingData = data.pricing;
                updatePrices();
            }
        } catch (error) {
            console.error('Error loading pricing:', error);
        }
    }

    // Update prices in the UI
    function updatePrices() {
        if (!pricingData) return;

        const usdToUyu = pricingData.usdToUyu;
        const isYearly = document.getElementById('billingToggle').checked;

        // Premium
        updatePlanPrice('premium', pricingData.plans.premium, usdToUyu, isYearly);

        // Pro
        updatePlanPrice('pro', pricingData.plans.pro, usdToUyu, isYearly);
    }

    function updatePlanPrice(planClass, planData, usdToUyu, isYearly) {
        const priceUSD = isYearly ? planData.yearly : planData.monthly;

        // Map plan classes to their initial monthly values for identification
        const planIdentifiers = {
            'premium': '2',
            'pro': '5'
        };

        // Find the plan card
        const amounts = document.querySelectorAll('.amount[data-yearly]');
        amounts.forEach(amount => {
            if (amount.dataset.monthly === planIdentifiers[planClass]) {
                // Update data attributes
                amount.dataset.monthly = planData.monthly;
                amount.dataset.yearly = planData.yearly;

                // Update displayed price
                amount.textContent = priceUSD;

                // Update UYU price
                const priceSecondary = amount.closest('.plan-price').querySelector('.price-secondary');
                if (priceSecondary) {
                    const monthlyUYU = Math.round(planData.monthly * usdToUyu);
                    const yearlyUYU = Math.round(planData.yearly * usdToUyu);

                    priceSecondary.dataset.monthly = `$${monthlyUYU.toLocaleString('es-UY')} UYU`;
                    priceSecondary.dataset.yearly = `$${yearlyUYU.toLocaleString('es-UY')} UYU`;
                    priceSecondary.textContent = isYearly ? priceSecondary.dataset.yearly : priceSecondary.dataset.monthly;
                }
            }
        });
    }

    // Billing cycle toggle functionality
    const billingToggle = document.getElementById('billingToggle');
    const amounts = document.querySelectorAll('.amount[data-yearly]');
    const secondaryPrices = document.querySelectorAll('.price-secondary[data-yearly]');

    billingToggle.addEventListener('change', function() {
        const isYearly = this.checked;

        if (pricingData) {
            updatePrices();
        } else {
            // Fallback to hardcoded prices if API fails
            amounts.forEach(amount => {
                const monthlyPrice = amount.dataset.monthly;
                const yearlyPrice = amount.dataset.yearly;
                amount.textContent = isYearly ? yearlyPrice : monthlyPrice;
            });

            secondaryPrices.forEach(price => {
                const monthlyPrice = price.dataset.monthly;
                const yearlyPrice = price.dataset.yearly;
                price.textContent = isYearly ? yearlyPrice : monthlyPrice;
            });
        }

        // Update period text
        const periods = document.querySelectorAll('.period');
        periods.forEach(period => {
            period.textContent = isYearly ? '/a√±o' : '/mes';
        });
    });

    // Load pricing on page load
    document.addEventListener('DOMContentLoaded', loadPricing);

    // Hamburger menu functionality
    const hamburger = document.querySelector('.hamburger');
    const navLinks = document.querySelector('.page-nav .nav-links');

    if (hamburger && navLinks) {
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');
        });

        // Close menu when clicking on a link
        const links = document.querySelectorAll('.page-nav .nav-links a');
        links.forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
            });
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.page-nav') && navLinks.classList.contains('active')) {
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
            }
        });
    }
    </script>
</body>
</html>
